<div class="container">
  <div class="row">
    <div class="leftside">
      <table class="table table-sm table-striped grade-table table-hover">
        <thead>
          <tr class="gradestop">
            <th class="projdesc" colspan="3" scope="col"><strong>Projects</strong></th>
            <th class="examdesc" colspan="2" scope="col"><strong>Exam Questions</strong></th>
            <th scope="col">Grade</th>
          </tr>
          <tr class="gradestop">
            <th class="smhgradecol" scope="col">Minimal</th>
            <th class="smhgradecol" scope="col">Satisfactory</th>
            <th class="lghgradecol" scope="col">Excellent</th>
            <th class="smhgradecol" scope="col">Satisfactory</th>
            <th class="lghgradecol" scope="col">Excellent</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <tr id="gradea">
            <td class="smgradecol" id="proj-min-5">5/5</td>
            <td class="smgradecol" id="proj-sat-5">5/5</td>
            <td class="lggradecol" id="proj-exc-2">2/5</td>
            <td class="smgradecol" id="exam-sat-11">11/12</td>
            <td class="lggradecol" id="exam-exc-6">6/12</td>
            <th scope="row">A</th>
          </tr>
          <tr id="gradeam">
            <td class="smgradecol">5/5</td>
            <td class="smgradecol" id="proj-sat-4">4/5</td>
            <td class="lggradecol">2/5</td>
            <td class="smgradecol">11/12</td>
            <td class="lggradecol" id="exam-exc-5">5/12</td>
            <th scope="row">A-</th>
          </tr>
          <tr>
            <td class="smgradecol" id="proj-min-4">4/5</td>
            <td class="smgradecol">4/5</td>
            <td class="lggradecol">2/5</td>
            <td class="smgradecol" id="exam-sat-10">10/12</td>
            <td class="lggradecol">5/12</td>
            <th scope="row">B+</th>
          </tr>
          <tr>
            <td class="smgradecol">4/5</td>
            <td class="smgradecol" id="proj-sat-3">3/5</td>
            <td class="lggradecol">2/5</td>
            <td class="smgradecol" id="exam-sat-9">9/12</td>
            <td class="lggradecol" id="exam-exc-4">4/12</td>
            <th scope="row">B</th>
          </tr>
          <tr>
            <td class="smgradecol">4/5</td>
            <td class="smgradecol">3/5</td>
            <td class="lggradecol" id="proj-exc-1">1/5</td>
            <td class="smgradecol">9/12</td>
            <td class="lggradecol" id="exam-exc-3">3/12</td>
            <th scope="row">B-</th>
          </tr>
          <tr>
            <td class="smgradecol" id="proj-min-3">3/5</td>
            <td class="smgradecol" id="proj-sat-2">2/5</td>
            <td class="lggradecol">1/5</td>
            <td class="smgradecol" id="exam-sat-8">8/12</td>
            <td class="lggradecol" id="exam-exc-2">2/12</td>
            <th scope="row">C+</th>
          </tr>
          <tr>
            <td class="smgradecol">3/5</td>
            <td class="smgradecol">2/5</td>
            <td class="lggradecol" id="proj-exc-0">0/5</td>
            <td class="smgradecol">8/12</td>
            <td class="lggradecol" id="exam-exc-1">1/12</td>
            <th scope="row">C</th>
          </tr>
          <tr>
            <td class="smgradecol">3/5</td>
            <td class="smgradecol">2/5</td>
            <td class="lggradecol">0/5</td>
            <td class="smgradecol" id="exam-sat-7">7/12</td>
            <td class="lggradecol" id="exam-exc-0">0/12</td>
            <th scope="row">C-</th>
          </tr>
          <tr>
            <td class="smgradecol">3/5</td>
            <td class="smgradecol" id="proj-sat-1">1/5</td>
            <td class="lggradecol">0/5</td>
            <td class="smgradecol" id="exam-sat-6">6/12</td>
            <td class="lggradecol">0/12</td>
            <th scope="row">D</th>
          </tr>
          <tr>
            <td class="smgradecol" id="proj-min-2">&lt; 3/5</td>
            <td class="smgradecol" id="proj-sat-0">0/5</td>
            <td class="lggradecol">0/5</td>
            <td class="smgradecol" id="exam-sat-5">&lt; 6/12</td>
            <td class="lggradecol">0/12</td>
            <th scope="row">&lt;D</th>
          </tr>
        </tbody>
      </table>

    </div>
    
    <div class="rightside">
      <!-- <div id="projectquestions"> -->
        <!--   <h5 class="pcardtitle">Projects</h5> -->
        <!--   <div id="projects" class="egrade" grade="A"> -->
          <!--     <svg width="100" height="100" viewPort="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg"> -->
            <!--       <circle class="pfail" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
            <!--       <circle class="pminimal" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
            <!--       <circle class="psat" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
            <!--       <circle class="pex" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
            <!--     </svg> -->
          <!--   </div> -->
        <!--   <p class="points"> -->
          <!--     3 <strong class="ex">Excellent</strong> -->
          <!--     &nbsp;5 <strong class="sat">Satisfactory</strong> -->
          <!--   </p> -->
        <!--   <p class="points" id="min">6 <strong class="min">Minimal</strong></p> -->
        <!-- </div> -->
      <!-- <div> -->
        <!--   <div id="examquestions"> -->
          <!--     <h5 class="pcardtitle">Exam Questions</h5> -->
          <!--     <div id="exams" class="egrade" grade="A"> -->
            <!--       <svg grade="A" class="gpa" width="100" height="100" viewPort="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg"> -->
              <!--         <circle class="efail" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
              <!--         <circle class="esat" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
              <!--         <circle class="eex" r="40" cx="50" cy="50" fill="transparent" stroke-dashoffset="0"></circle> -->
              <!--       </svg> -->
            <!--     </div> -->
          <!--     <p class="points"> -->
            <!--       6 <strong class="ex">Excellent</strong> -->
            <!--       &nbsp;12 <strong class="sat">Satisfactory</strong> -->
            <!--     </p> -->
          <!--   </div> -->
        <!-- </div> -->
      <table class="table table-sm table-striped grade-table participation">
        <thead>
          <tr class="gradestop">
            <th scope="col"><strong>Participation</strong></th>
            <th scope="col"><strong>GPA Δ</strong></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="smgradecol" id="part-minus">&lt; 20</td>
            <th scope="row">-</th>
          </tr>
          <tr>
            <td class="smgradecol" id="part-stay">≥ 20 – &lt; 30</td>
            <th scope="row">=</th>
          </tr>
          <tr>
            <td class="smgradecol" id="part-plus">≥ 30</td>
            <th scope="row">+</th>
          </tr>
        </tbody>
      </table>
      <div class="div_calc">
        <p style="text-align: center; font-size: 16pt; margin-bottom: 0px;">Grade calculator</p>
        <p style="text-align: center; font-size: 12pt; margin-bottom: 0px;">Projects</p>
        <form onkeyup="calculate()">
          <div class="leftside_calc" style="width: 200px;padding-right: 10px;">
            <label for="Proj">Minimal:</label>
            <input type="text" id="proj_mini" name="exam_exce" size="7" style="float:right" required="" value="3">
            <label for="Proj">Satisfactory:</label>
            <input type="text" id="proj_sati" name="exam_sati" size="7" style="float:right" required="" value="3">
            <label for="Proj">Excellent:</label>
            <input type="text" id="proj_exce" name="exam_exce" size="7" style="float:right" required="" value="2">
          </div>
          <p style="text-align: center; font-size: 12pt; margin-bottom: 0px;">Exams</p>
          <div class="rightside_calc" style="width: 200px;padding-right: 10px;">
            <label for="Exam">Satisfactory:</label>
            <input type="text" id="exam_sati" name="exam_sati" size="7" style="float:right" required="" value="6">
            <label for="Exam">Excellent:</label>
            <input type="text" id="exam_exce" name="exam_exce" size="7" style="float:right" required="" value="3">
            <p style="text-align: center; font-size: 12pt; margin-bottom: 0px;">Participation</p>
            <label for="Exam">Points:</label>
            <input type="text" id="exam_part" name="exam_part" size="7" style="float:right" required="" value="16">
            <p id="calc_result_0" style="display:inline-block;">Projected grade:</p>
            <h3 id="calc_result" style="display:inline-block;"> </h3>
          </div>

        </form>
        <style>
          .table-sm td, .table-sm th {padding:0.4rem;}
        </style>
        <script>
          function place_highlights(proj_min, proj_sat, proj_exc, exam_sat, exam_exc, part) {
              function clamp(v, min, max) {
                  return Math.min(Math.max(v, min), max);
              }
              function clear_col(base, min, max) {
                  var i;
                  for (i=min; i <= max; i++) {
                      var combined = base + i.toString();
                      var element = document.getElementById(combined);
                      element.style.backgroundColor = 'white';
                  }
              }
              function highlight(ele) {
                  document.getElementById(ele).style.backgroundColor = "orange";
              }
              // first clear everything
              clear_col("proj-min-", 2, 5);
              clear_col("proj-sat-", 0, 5);
              clear_col("proj-exc-", 0, 2);
              clear_col("exam-sat-", 5, 11);
              clear_col("exam-exc-", 0, 6);
              // clear participation too
              document.getElementById("part-minus").style.backgroundColor = "white";
              document.getElementById("part-stay").style.backgroundColor = "white";
              document.getElementById('part-plus').style.backgroundColor = "white";
	      
              var pm_clamped = clamp(proj_min, 2, 5);
              highlight("proj-min-" + pm_clamped.toString());
              var ps_clamped = clamp(proj_sat, 0, 5);
              highlight("proj-sat-" + ps_clamped.toString());
              var pe_clamped = clamp(proj_exc, 0, 2);
              highlight("proj-exc-" + pe_clamped.toString());
              var es_clamped = clamp(exam_sat, 5, 11);
              highlight("exam-sat-" + es_clamped.toString());
              var ee_clamped = clamp(exam_exc, 0, 6);
              highlight("exam-exc-" + ee_clamped.toString());
              if (part < 20) {
                  highlight("part-minus");
              } else if (part >= 30) {
                  highlight("part-plus");
              } else {
                  highlight("part-stay");
              }
          }
          
          function calculate() {
              var es = parseInt(document.getElementById('exam_sati').value)
              var ee = parseInt(document.getElementById('exam_exce').value)
              var pm = parseInt(document.getElementById('proj_mini').value)
              var ps = parseInt(document.getElementById('proj_sati').value)
              var pe = parseInt(document.getElementById('proj_exce').value)
              var pa = parseInt(document.getElementById('exam_part').value)
	      
              var grade = [pm,ps,pe,es,ee]
              var grade_a = [5,5,2,11,6]
              var grade_am = [5,4,2,11,5]
              var grade_bp = [4,4,2,10,5]
              var grade_b = [4,3,2,9,4]
              var grade_bm = [4,3,1,9,3]
              var grade_cp = [3,2,1,8,2]
              var grade_c = [3,2,0,8,1]
              var grade_cm = [3,2,0,7,0]
              var grade_d = [3,1,0,6,0]

              var calibrate = [grade_a, grade_am, grade_bp, grade_b, grade_bm, grade_cp, grade_c, grade_cm, grade_d]
              var count = [0,0,0,0,0]
              var validcheck = (es >= ee) && (pe <= ps) && (ps <= pm) && (es<=12) && (pm<=5) && (pe>=0) && (ee>=0)
              var complete = !isNaN(pm) && !isNaN(ps) && !isNaN(pe) && !isNaN(es) && !isNaN(ee) && !isNaN(pa);
              // console.log(complete)
              for(i=0;i<5;i++){
                  // console.log(i)
                  for(j=0;j<9;j++){
                      if(grade[i]<calibrate[j][i]){
			  count[i]++;
                      }
                  }
              }
              if(complete && validcheck){
                  var rowsink = Math.max.apply(null, count)
                  if(pa>=30) rowsink--;
                  else if(pa<20) rowsink++;
                  if(rowsink>9){
                      result = "F";
                  }
                  else if(rowsink<0){
                      result = "A"
                  }
                  else{
                      result = ["A","A-","B+","B","B-","C+","C","C-","D","F"][rowsink]
                  }
                  if (result) {
                      document.getElementById("calc_result_0").innerHTML = "Projected grade:";
                      document.getElementById("calc_result").innerHTML = result;
                  }
                  place_highlights(pm, ps, pe, es, ee, pa)
              }
              else if(!complete && validcheck){
                  document.getElementById("calc_result_0").innerHTML = "Please complete form";
                  document.getElementById("calc_result").innerHTML = "";
              }
              else if(complete && !validcheck){
                  document.getElementById("calc_result_0").innerHTML = "Invalid scores";
                  document.getElementById("calc_result").innerHTML = "";
              }
          }
        </script>
      </div>
    </div>
  </div>
</div>
